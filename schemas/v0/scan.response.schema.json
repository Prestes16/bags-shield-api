{
  "type": "object",
  "properties": {
    "success": { "type": "boolean" },
    "response": {
      "type": "object",
      "properties": {
        "token": {
          "type": "object",
          "properties": {
            "mint": { "type": "string" },
            "name": { "type": "string" },
            "symbol": { "type": "string" },
            "decimals": { "type": "integer" }
          },
          "required": ["mint"]
        },
        "badges": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["key","title","severity","impact"],
            "properties": {
              "key": { "type": "string" },
              "title": { "type": "string" },
              "severity": { "type": "string", "enum": ["low","medium","high","critical"] },
              "impact": { "type": "string", "enum": ["neutral","negative","positive"] },
              "tags": { "type": "array", "items": { "type": "string" } }
            }
          }
        },
        "shieldScore": {
          "type": "object",
          "required": ["grade","score"],
          "properties": {
            "grade": { "type": "string", "enum": ["A","B","C","D","E"] },
            "score": { "type": "integer", "minimum": 0, "maximum": 100 },
            "rationale": { "type": "string" },
            "rulesTriggered": { "type": "array", "items": { "type": "string" } }
          }
        },
        "summary": { "type": "string" }
      }
    },
    "meta": {
      "type": "object",
      "required": ["requestId","version","timestamp"],
      "properties": {
        "requestId": { "type": "string" },
        "version": { "type": "string" },
        "timestamp": { "type": "string" },
        "processingMs": { "type": "integer" }
      }
    }
  },
  "required": ["success","meta"]
}

